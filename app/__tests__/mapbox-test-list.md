# Mapbox機能テストリスト（t-wadaのTDD法則）

## 優先度1：クリティカルな基本機能

### 環境変数管理
- [ ] 環境変数からMapboxアクセストークンが取得できる
- [ ] 環境変数からカスタムスタイルURLが取得できる
- [ ] 無効な環境変数の場合にエラーが発生する
- [ ] 環境変数が未設定の場合にデフォルト値を使用する

### Mapbox初期化
- [ ] 有効なアクセストークンでMapboxインスタンスが作成される
- [ ] 無効なアクセストークンでエラーが発生する
- [ ] マップコンテナが正しく初期化される
- [ ] ブラウザでMapbox GL JSがサポートされているかチェックできる

### カスタムスタイル適用
- [ ] 指定されたカスタムスタイルURL「mapbox://styles/saku-0109/cmdb2t1uq03d301r447l5hnif」が適用される
- [ ] スタイル読み込み完了時にイベントが発火される
- [ ] 無効なスタイルURLでエラーハンドリングされる
- [ ] スタイル変更が動的に適用される

### ビューポート管理
- [ ] 初期座標（緯度・経度）が正しく設定される
- [ ] 初期ズームレベルが正しく設定される
- [ ] ビューポート変更時にコールバックが実行される
- [ ] 座標の境界値チェックが機能する

## 優先度2：重要なUI機能

### マップコンテナ
- [ ] マップコンテナがDOM上に正しくレンダリングされる
- [ ] レスポンシブデザインでコンテナサイズが調整される
- [ ] フルスクリーン表示が可能
- [ ] コンテナの最小・最大サイズが制御される

### ナビゲーションコントロール
- [ ] ズームイン・ズームアウトボタンが機能する
- [ ] コンパス（方位）ボタンが機能する
- [ ] フルスクリーンボタンが機能する
- [ ] コントロールの位置が設定可能

### エラーハンドリング
- [ ] ネットワークエラー時に適切なエラーメッセージが表示される
- [ ] 無効なトークン時にユーザーフレンドリーなエラーが表示される
- [ ] マップ読み込み失敗時にフォールバック表示される
- [ ] エラー情報がログに記録される

## 優先度3：高度な機能

### パフォーマンス
- [ ] 大きなビューポート変更時にスムーズにアニメーションする
- [ ] メモリリークが発生しない（コンポーネントアンマウント時）
- [ ] 複数のマップインスタンスが適切に管理される
- [ ] 非同期処理が適切にキャンセルされる

### 三角測量対象
- [ ] 複数の座標セット（東京、大阪、福岡）で同じ動作を確認
- [ ] 複数のズームレベル（5, 10, 15）で一貫した動作
- [ ] 複数のスタイルURL（Streets, Satellite, Custom）で機能確認

## 実装順序（TDDサイクル）

1. **環境変数管理** → 最も基本的で他の機能の前提条件
2. **Mapbox初期化** → マップ表示の核となる機能
3. **カスタムスタイル適用** → ユーザー指定の要件
4. **ビューポート管理** → マップ操作の基本
5. **エラーハンドリング** → 堅牢性の確保
6. **パフォーマンス** → 実用性の向上

## テスト戦略

- **ユニットテスト**: 各機能を単独でテスト
- **統合テスト**: コンポーネント間の連携をテスト  
- **Red-Green-Refactor**: 各項目でt-wadaのサイクルを厳密に実行
- **三角測量**: 複雑な座標・スタイル処理で複数パターンを検証